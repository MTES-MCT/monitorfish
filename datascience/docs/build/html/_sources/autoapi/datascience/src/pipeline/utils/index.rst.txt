:mod:`datascience.src.pipeline.utils`
=====================================

.. py:module:: datascience.src.pipeline.utils


Module Contents
---------------


Functions
~~~~~~~~~

.. autoapisummary::

   datascience.src.pipeline.utils.get_table
   datascience.src.pipeline.utils.delete
   datascience.src.pipeline.utils.psql_insert_copy
   datascience.src.pipeline.utils.move



.. function:: get_table(table_name: str, schema: str, engine: sqlalchemy.engine.base.Engine, logger: logging.Logger) -> sqlalchemy.Table

   Performs reflection to get a sqlalchemy Table object with metadata reflecting
   the table found in the databse. Returns resulting Table object.

   If the table is not found in the database, raises an error.


.. function:: delete(table: sqlalchemy.Table, connection: sqlalchemy.engine.base.Connection, logger: logging.Logger)

   Deletes all row from a table.
   Useful to wipe a table before re-inserting fresh data in ETL jobs.


.. function:: psql_insert_copy(table, conn, keys, data_iter)

   Execute SQL statement inserting data

   :param table:
   :type table: pandas.io.sql.SQLTable
   :param conn:
   :type conn: sqlalchemy.engine.Engine or sqlalchemy.engine.Connection
   :param keys: Column names
   :type keys: list of str
   :param data_iter:
   :type data_iter: Iterable that iterates the values to be inserted


.. function:: move(src_fp: pathlib.Path, dest_dirpath: pathlib.Path, if_exists: str = 'raise') -> None

   Moves a file to another directory. If the destination directory
   does not exist, it is created, as well as all intermediate directories.


